Project Scope: This repository has the source code for the custom systems I have setup on my project car, a BMW E36, which has an Arduino Mega and Raspberry Pi 4 installed on it to gather data and control certain parts of the car to optimize performance.

Current Arduino Systems:
- PWM Fan Control: The arduino takes in the coolant temp of the car as an input, and adjusts the fan speed (DC) accordingly using PWM. The logic is that below 170째F, the fans are turned off. Between 170째F and 190째F, the duty cycle of the fans follow a linear relationship between 0 and 100% (0 to 255 PWM). Above 190째F, the fans are operated at 100% duty cycle.
- Fuel Pump Control: The arduino takes an input from the manifold air pressure sensor (MAP), where as soon as it sees positive pressure (boost), the secondary fuel pump is activated. The reason for this is because the single Walbro 450 is unable to provide enough fuel to the car (Turbocharged BMW E36 M3) on E85 above 700hp. A secondary Walbro 450 has been installed and will be triggered with the arduino.
- Wheel Speed Sensors: The arduino is used to get wheel speed readings that are used for the traction control algorithm, and can eventually be used for stability control and ABS. Since the wheel speed sensors on a BMW are variable reluctance sensors, we need to convert this signals to DC square waves like a hall effect sensor outputs. For each of the wheel speed sensors, an interrupt is called on the rising edge (when digital input goes from 0 to 1). After a certain amount of time (the frequency), the pulses are counted, indicating the amount of rotations during that time period. This is then converted to linear speed (m/s) to be used in the traction control algorithm.
- PID Traction Control Algorithm: This algorithm uses the wheel speeds calculated from the wheel speed function in order to reduce the torque of the car when the car loses traction. The average of the front two wheels is used to calculate the vehicle's speed. The goal of the algorithm is to maintain a slip ratio less than 0.10 between the driving wheels (rear wheels, since the car is RWD) and the vehicle speed. If the arduino sees that one of the rear wheel's slip exceeds 0.10 of a slip ratio, it will use PID control to adjust the electronic throttle, therefore reducing the torque that the motor is producing, and therefore reduce the slip.

Future Systems to be designed:
- ABS System: Although the car is equipped with ABS from factory, the technology is extremely old and is unable to integrated with the arduino. Having a tunable ABS System could allow me to create different settings depending on the use of the car (on the street vs. the track).
- Stability Control: To prevent the car from oversteering or understeering, I plan to implement stability control. To do this, I'll need to get sensors that will allow me to model the vehicle dynamics of the car (yaw rate, steering angle, and acceleration sensors) and create a stability control algorithm based off of this. This algorithm can use the ABS system to apply brake torque to certain wheels to correct for oversteer/understeer and get the vehicle back on the driver's desired path.
